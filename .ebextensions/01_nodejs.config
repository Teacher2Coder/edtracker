option_settings:
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    NPM_USE_PRODUCTION: false
    SKIP_SEEDING: true
  aws:elasticbeanstalk:command:
    Timeout: 2400
  aws:autoscaling:launchconfiguration:
    InstanceType: t3.micro
    SecurityGroups: default

container_commands:
  01_install_root_dependencies:
    command: "npm install --production"
    cwd: "/var/app/ondeck"
  02_install_server_dependencies:
    command: "cd server && npm install --production"
    cwd: "/var/app/ondeck"
  03_install_client_dependencies:
    command: "cd client && npm install"
    cwd: "/var/app/ondeck"
  04_build_client:
    command: "cd client && npm run build"
    cwd: "/var/app/ondeck"
  05_verify_build:
    command: "ls -la client/dist/ || echo 'Build directory not found'"
    cwd: "/var/app/ondeck"
    ignoreErrors: true
  06_cleanup_client_node_modules:
    command: "rm -rf client/node_modules"
    cwd: "/var/app/ondeck"
    ignoreErrors: true 